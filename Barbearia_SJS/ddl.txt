CREATE TABLE Conta (id  SERIAL NOT NULL, DTFECHAMENTO DATE, TOTAL FLOAT, PAGAMENTO_ID INTEGER, PRIMARY KEY (id))
CREATE TABLE PAGAMENTO (ID  SERIAL NOT NULL, DTYPE VARCHAR(31), VALORPAGO FLOAT, PERCENTUALDESCONTO INTEGER, CARTAO VARCHAR(255), QUANTIDADEPARCELAS INTEGER, PRIMARY KEY (ID))
CREATE TABLE Pessoa (ID  SERIAL NOT NULL, DTYPE VARCHAR(31), DATANASC DATE, NOME VARCHAR(30) NOT NULL, SOBRENOME VARCHAR(50) NOT NULL, OCUPADO BOOLEAN, PRIMARY KEY (ID))
CREATE TABLE Servico (TIPO INTEGER NOT NULL, IDCLIENTE INTEGER NOT NULL, IDBARBEIRO INTEGER NOT NULL, DATA DATE, PRIMARY KEY (TIPO, IDCLIENTE, IDBARBEIRO))
CREATE TABLE Tipo (ID  SERIAL NOT NULL, NOME VARCHAR(30) NOT NULL UNIQUE, PRECO FLOAT, PRIMARY KEY (ID))
CREATE TABLE Pessoa_Servico (Barbeiro_ID INTEGER NOT NULL, TIPO INTEGER NOT NULL, IDCLIENTE INTEGER NOT NULL, IDBARBEIRO INTEGER NOT NULL, Cliente_ID INTEGER NOT NULL, PRIMARY KEY (Barbeiro_ID, TIPO, IDCLIENTE, IDBARBEIRO, Cliente_ID))
CREATE TABLE Pessoa_Conta (Cliente_ID INTEGER NOT NULL, contas_id INTEGER NOT NULL, PRIMARY KEY (Cliente_ID, contas_id))
ALTER TABLE Conta ADD CONSTRAINT UNQ_Conta_0 UNIQUE (numero)
ALTER TABLE Pessoa ADD CONSTRAINT UNQ_Pessoa_0 UNIQUE (id)
ALTER TABLE Servico ADD CONSTRAINT UNQ_Servico_0 UNIQUE (idBarbeiro, idCliente, tipo)
ALTER TABLE Tipo ADD CONSTRAINT UNQ_Tipo_0 UNIQUE (id)
ALTER TABLE Conta ADD CONSTRAINT FK_Conta_PAGAMENTO_ID FOREIGN KEY (PAGAMENTO_ID) REFERENCES PAGAMENTO (ID)
ALTER TABLE Pessoa_Servico ADD CONSTRAINT FK_Pessoa_Servico_Barbeiro_ID FOREIGN KEY (Barbeiro_ID) REFERENCES Pessoa (ID)
ALTER TABLE Pessoa_Servico ADD CONSTRAINT FK_Pessoa_Servico_TIPO FOREIGN KEY (TIPO, IDCLIENTE, IDBARBEIRO) REFERENCES Servico (TIPO, IDCLIENTE, IDBARBEIRO)
ALTER TABLE Pessoa_Servico ADD CONSTRAINT FK_Pessoa_Servico_Cliente_ID FOREIGN KEY (Cliente_ID) REFERENCES Pessoa (ID)
ALTER TABLE Pessoa_Conta ADD CONSTRAINT FK_Pessoa_Conta_Cliente_ID FOREIGN KEY (Cliente_ID) REFERENCES Pessoa (ID)
ALTER TABLE Pessoa_Conta ADD CONSTRAINT FK_Pessoa_Conta_contas_id FOREIGN KEY (contas_id) REFERENCES Conta (id)
